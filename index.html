<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>VR Photo Portfolio</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <a-scene>
        <a-assets>
          <img id="cubeTexture" src="./assets/a.png">
        </a-assets>
        <!-- キューブ型の部屋の定義 -->
        <a-box position="0 5 0" width="10" height="10" depth="10" 
           material="src: #cubeTexture; repeat: 1 1" side="back"></a-box>

        <a-assets>
            <!-- ここに写真のアセットを追加します -->
            <img id="photo1" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo2" src="https://live.staticflickr.com/65535/53324907283_21ad32570c_h.jpg">
            <img id="photo3" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo4" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo5" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo6" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo7" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo8" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo9" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <img id="photo10" src="https://live.staticflickr.com/65535/53098018469_eb8b162a71_k.jpg">
            <!-- 他の写真も同様に追加 -->
        </a-assets>

        <!-- 写真が回転する円環 -->
        <a-entity id="photo-circle" rotation="0 0 0"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 20000; easing: linear">
        </a-entity>

        <!-- カメラ（ユーザー）の設定 -->
        <a-camera position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-camera>

    </a-scene>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var radius = 3;
        var photoCircle = document.getElementById('photo-circle');
        var photos = []; // 写真要素を格納する配列

        // 写真のIDを配列に格納
        var photoIds = [];
        var numberOfPhotos = 10; // 写真の枚数
        for (var i = 1; i <= numberOfPhotos; i++) {
            photoIds.push('photo' + i);
        }


        photoIds.forEach(function(photoId, i) {
            var theta = (i / photoIds.length) * Math.PI * 2;
            var x = radius * Math.cos(theta);
            var y = 1.5;
            var z = radius * Math.sin(theta);

            var photoEl = document.createElement('a-image');
            photoEl.setAttribute('src', '#' + photoId);
            photoEl.setAttribute('position', {x: x, y: y, z: z});

            setPhotoAspectRatio(photoEl, photoId);

            photoCircle.appendChild(photoEl);
            photos.push(photoEl);
        });

        function setPhotoAspectRatio(photoElement, imgId) {
            var img = document.getElementById(imgId);
            var src = img.src; // 実際の画像ファイルのパスを取得

            var tempImg = new Image();
            tempImg.onload = function() {
                var aspectRatio = tempImg.width / tempImg.height;
                photoElement.setAttribute('width', aspectRatio);
                photoElement.setAttribute('height', 1);
            };
            tempImg.src = src;
        }

        function updatePhotos() {
            photos.forEach(function(photo) {
                var camera = document.querySelector('[camera]').object3D.position;
                var target = new THREE.Vector3(camera.x, camera.y, camera.z);
                photo.object3D.lookAt(target);
            });
        }

        AFRAME.registerComponent('photo-look-at', {
            tick: function() {
                updatePhotos();
            }
        });

        photoCircle.setAttribute('photo-look-at', '');
      });
    </script>

</body>
</html>
